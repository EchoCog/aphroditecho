{% extends 'base.html' %}

{% block title %}User Memory - Deep Tree Echo{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <div class="row mb-4">
        <div class="col-12">
            <h1><i class="bi bi-person-lines-fill"></i> User Memory</h1>
            <p class="lead">Storage and retrieval of user-specific information and personalized content</p>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-8">
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="card-title mb-0">Memory Categories</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="memory-category mb-3">
                                <h6><i class="bi bi-star"></i> Preferences</h6>
                                <p>User interface, theme, and interaction preferences</p>
                                <button class="btn btn-sm btn-outline-primary">Access</button>
                            </div>
                            <div class="memory-category mb-3">
                                <h6><i class="bi bi-journal-text"></i> Learning History</h6>
                                <p>Records of learning activities and knowledge acquisition</p>
                                <button class="btn btn-sm btn-outline-primary">Access</button>
                            </div>
                            <div class="memory-category mb-3">
                                <h6><i class="bi bi-graph-up"></i> Progress Tracking</h6>
                                <p>Skill development and project completion metrics</p>
                                <button class="btn btn-sm btn-outline-primary">Access</button>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="memory-category mb-3">
                                <h6><i class="bi bi-diagram-3"></i> Concept Networks</h6>
                                <p>Personalized knowledge maps and concept relationships</p>
                                <button class="btn btn-sm btn-outline-primary">Access</button>
                            </div>
                            <div class="memory-category mb-3">
                                <h6><i class="bi bi-calendar-check"></i> Activity Timeline</h6>
                                <p>Chronological record of user interactions and achievements</p>
                                <button class="btn btn-sm btn-outline-primary">Access</button>
                            </div>
                            <div class="memory-category mb-3">
                                <h6><i class="bi bi-pin-angle"></i> Saved Content</h6>
                                <p>Bookmarked resources, notes, and custom content</p>
                                <button class="btn btn-sm btn-outline-primary">Access</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card mb-4">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="card-title mb-0">Memory Explorer</h5>
                    <div class="btn-group">
                        <button class="btn btn-sm btn-outline-primary">Recent</button>
                        <button class="btn btn-sm btn-outline-primary">Frequent</button>
                        <button class="btn btn-sm btn-outline-primary">Favorites</button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="memory-explorer">
                        <div class="list-group">
                            <a href="#" class="list-group-item list-group-item-action">
                                <div class="d-flex w-100 justify-content-between">
                                    <h6 class="mb-1">Learning Progress: Recursive Systems</h6>
                                    <small class="text-muted">3 days ago</small>
                                </div>
                                <p class="mb-1">Completed 7/10 modules with 85% comprehension score</p>
                                <small class="text-muted">Category: Learning History</small>
                            </a>
                            <a href="#" class="list-group-item list-group-item-action">
                                <div class="d-flex w-100 justify-content-between">
                                    <h6 class="mb-1">Interface Preferences Update</h6>
                                    <small class="text-muted">1 week ago</small>
                                </div>
                                <p class="mb-1">Changed theme to dark mode and enabled advanced visualization options</p>
                                <small class="text-muted">Category: Preferences</small>
                            </a>
                            <a href="#" class="list-group-item list-group-item-action">
                                <div class="d-flex w-100 justify-content-between">
                                    <h6 class="mb-1">Concept Map: Self-Reference in Complex Systems</h6>
                                    <small class="text-muted">2 weeks ago</small>
                                </div>
                                <p class="mb-1">Personal knowledge map with 15 concepts and 23 connections</p>
                                <small class="text-muted">Category: Concept Networks</small>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="card-title mb-0">Memory Statistics</h5>
                </div>
                <div class="card-body">
                    <div class="memory-stats">
                        <div class="stat-item mb-3">
                            <div class="d-flex justify-content-between">
                                <div>Total Memory Items</div>
                                <div class="fw-bold">157</div>
                            </div>
                            <div class="progress mt-1">
                                <div class="progress-bar bg-primary" role="progressbar" style="width: 78%" aria-valuenow="78" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                        </div>
                        <div class="stat-item mb-3">
                            <div class="d-flex justify-content-between">
                                <div>Storage Usage</div>
                                <div class="fw-bold">32%</div>
                            </div>
                            <div class="progress mt-1">
                                <div class="progress-bar bg-success" role="progressbar" style="width: 32%" aria-valuenow="32" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                        </div>
                        <div class="stat-item mb-3">
                            <div class="d-flex justify-content-between">
                                <div>Recall Efficiency</div>
                                <div class="fw-bold">91%</div>
                            </div>
                            <div class="progress mt-1">
                                <div class="progress-bar bg-info" role="progressbar" style="width: 91%" aria-valuenow="91" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                        </div>
                    </div>

                    <div class="memory-distribution mt-4">
                        <h6>Memory Distribution</h6>
                        <canvas id="memory-chart" height="200"></canvas>
                    </div>
                </div>
            </div>

            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="card-title mb-0">Memory Actions</h5>
                </div>
                <div class="card-body">
                    <div class="d-grid gap-2">
                        <button class="btn btn-primary">
                            <i class="bi bi-search"></i> Search Memory
                        </button>
                        <button class="btn btn-outline-primary">
                            <i class="bi bi-arrow-repeat"></i> Consolidate Memory
                        </button>
                        <button class="btn btn-outline-primary">
                            <i class="bi bi-box-arrow-in-down"></i> Import Memory
                        </button>
                        <button class="btn btn-outline-primary">
                            <i class="bi bi-box-arrow-up"></i> Export Memory
                        </button>
                        <button class="btn btn-outline-danger">
                            <i class="bi bi-trash"></i> Clear Unused Memory
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Memory distribution chart
        const ctx = document.getElementById('memory-chart').getContext('2d');
        const memoryChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['Preferences', 'Learning History', 'Progress Tracking', 
                         'Concept Networks', 'Activity Timeline', 'Saved Content'],
                datasets: [{
                    data: [15, 25, 20, 18, 12, 10],
                    backgroundColor: [
                        '#3b82f6', // Blue
                        '#10b981', // Green
                        '#f59e0b', // Amber
                        '#8b5cf6', // Purple
                        '#ef4444', // Red
                        '#6b7280'  // Gray
                    ]
                }]
            },
            options: {
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                }
            }
        });

        // Memory data loading would be implemented here
        console.log("User memory interface loaded");
        
        // Add API calls to fetch actual memory data
        fetch('/api/memory/user')
            .then(response => response.json())
            .then(data => {
                console.log("Memory data loaded", data);
                // Update the UI with the loaded data
            })
            .catch(error => {
                console.error("Failed to fetch memory data:", error);
            });
    });
</script>
{% endblock %}